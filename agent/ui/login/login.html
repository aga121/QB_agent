<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Queen Bee - æ™ºèƒ½ä½“åˆ†äº«å¹³å°</title>
    <link rel="stylesheet" href="/static/cdn_resourc/layui/css/layui.css">
    <link rel="stylesheet" href="/static/cdn_resourc/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="/static/login/login.css">
</head>
<body>
    <div class="ambient-light">
        <div class="light-orb orb-1"></div>
        <div class="light-orb orb-2"></div>
        <div class="light-orb orb-3"></div>
    </div>

    <div class="dust-particles" id="particles"></div>

    <nav class="glass-nav reveal-down">
        <div class="nav-logo"><i class="fas fa-crown"></i> Queen Bee</div>
        <div class="nav-links">
            <span>äº§å“æ¡ˆä¾‹</span>
            <span>å…³äºæˆ‘ä»¬</span>
        </div>
    </nav>

    <section class="hero-section" id="hero">
        <div class="hero-content">
            <div class="hero-text reveal-left">
                <span class="brand-tag">INTELLIGENCE SWARM</span>
                <h1 class="gradient-text">Orchestrate <br>Your Future</h1>
                <p class="subtitle">ä»¥ä¼˜é›…çš„æ–¹å¼ï¼Œé©¾é©­å¤æ‚çš„ç¾¤ä½“æ™ºèƒ½ã€‚<br>æ–°ä¸€ä»£ä¼ä¸šçº§æ™ºèƒ½ä½“åä½œå¹³å°ã€‚</p>
                <div class="hero-stats">
                    <div class="stat-item">
                        <span class="num">10k+</span>
                        <span class="label">Agents Active</span>
                    </div>
                    <div class="stat-item">
                        <span class="num">99.9%</span>
                        <span class="label">Reliability</span>
                    </div>
                </div>
            </div>

            <div class="login-wrapper reveal-right">
                <div class="login-container">
                    <div class="login-header">
                        <h2>Welcome Back</h2>
                        <p>ç™»å½•æ§åˆ¶å°ï¼Œå¼€å¯æ™ºæ…§ä¹‹æ—…</p>
                    </div>

                    <form class="layui-form login-form" id="loginForm" lay-filter="loginForm">
                        <div class="layui-form-item floating-label">
                            <input type="text" name="phone" placeholder=" " autocomplete="off" class="layui-input">
                            <label>æ‰‹æœºå·</label>
                            <i class="layui-icon layui-icon-cellphone"></i>
                        </div>
                        <div class="layui-form-item code-row floating-label">
                            <div class="input-group">
                                <input type="text" name="code" placeholder=" " autocomplete="off" class="layui-input">
                                <label>éªŒè¯ç </label>
                                <i class="layui-icon layui-icon-vercode"></i>
                            </div>
                            <button type="button" class="code-btn" id="sendCodeBtn">è·å–éªŒè¯ç </button>
                        </div>

                        <button type="submit" class="layui-btn login-btn">
                            <span>ç«‹å³ç™»å½•</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>

                        <div class="form-footer">
                            <button type="button" class="text-btn" id="clearPhoneBtn">åˆ‡æ¢/æ¸…é™¤è´¦å·</button>
                        </div>

                        <div class="agreement-tip">
                            <input type="checkbox" id="agreeCheckbox" lay-ignore style="vertical-align: middle; margin-right: 4px;">
                            <span style="vertical-align: middle;">æˆ‘å·²é˜…è¯»å¹¶åŒæ„<a href="/terms/user-agreement" target="_blank">ã€Šç”¨æˆ·åè®®ã€‹</a>å’Œ<a href="/terms/privacy-policy" target="_blank">ã€Šéšç§æ”¿ç­–ã€‹</a>ï¼Œæœªæ³¨å†Œçš„æ‰‹æœºå·å°†è‡ªåŠ¨åˆ›å»ºè´¦å·</span>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="scroll-mouse" onclick="scrollToSection('showcase')">
            <div class="mouse-wheel"></div>
        </div>
    </section>

    <section class="section showcase-section" id="showcase">
        <div class="container">
            <div class="section-header reveal-up">
                <span class="tag">Use Cases</span>
                <h2 class="dark-title">çªç ´æ•ˆç‡çš„è¾¹ç•Œ</h2>
                <div class="title-line"></div>
            </div>

            <div class="big-case reveal-scale">
                <div class="case-visual">
                    <img src="/static/cdn_resourc/placehold/qb-workflow.png" alt="Dashboard" class="tilt-image">
                </div>
                <div class="case-content glass-card">
                    <h3>ä¼ä¸šçº§å·¥ä½œæµç¼–æ’</h3>
                    <p>é€šè¿‡å¯è§†åŒ–æ‹–æ‹½ï¼Œå°†æ•°ç™¾ä¸ª AI æ™ºèƒ½ä½“ä¸²è”æˆå¤æ‚çš„ä¸šåŠ¡æµæ°´çº¿ã€‚ç®€çº¦è€Œä¸ç®€å•ã€‚</p>
                    <ul class="feature-tags">
                        <li><i class="fas fa-check"></i> æ¯«ç§’çº§å“åº”</li>
                        <li><i class="fas fa-check"></i> å¯è§†åŒ–ç¼–æ’</li>
                    </ul>
                </div>
            </div>

            <div class="dual-case">
                <div class="case-row reveal-up">
                    <div class="case-info">
                        <h3><i class="fas fa-chart-pie"></i> æ™ºèƒ½æ•°æ®æ´å¯Ÿ</h3>
                        <p>ä¸å†éœ€è¦ç­‰å¾…åˆ†æå¸ˆçš„å‘¨æŠ¥ã€‚QB æ•°æ®æ™ºèƒ½ä½“å®æ—¶ç›‘æ§ä¸šåŠ¡æŒ‡æ ‡ï¼Œä»¥æœ€ç›´è§‚çš„æ–¹å¼å‘ˆç°ä»·å€¼ã€‚</p>
                    </div>
                    <div class="case-img-wrapper">
                        <img src="/static/cdn_resourc/placehold/data-analytics.png" alt="Analytics">
                    </div>
                </div>

                <div class="case-row reverse reveal-up">
                    <div class="case-info">
                        <h3><i class="fas fa-code"></i> è‡ªåŠ¨åŒ–ç ”å‘åŠ©ç†</h3>
                        <p>è®© AI æ¥ç®¡ç¹ççš„å•å…ƒæµ‹è¯•ä¸æ–‡æ¡£ç¼–å†™ã€‚è®©ä»£ç åƒè¯—ä¸€æ ·ä¼˜é›…ã€‚</p>
                    </div>
                    <div class="case-img-wrapper">
                        <img src="/static/cdn_resourc/placehold/code-assistant.png" alt="Coding">
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="section features-section">
        <div class="container">
            <div class="section-header reveal-up">
                <span class="tag">Core Features</span>
                <h2 class="dark-title">æ„å»ºæœªæ¥çš„åŸºçŸ³</h2>
            </div>

            <div class="bento-grid">
                <div class="bento-card span-2 reveal-up" style="transition-delay: 0.1s">
                    <div class="card-icon"><i class="fas fa-brain"></i></div>
                    <h3>åˆ†å¸ƒå¼å¤§è„‘</h3>
                    <p>ç‹¬åˆ›çš„ Swarm Consensus ç®—æ³•ï¼Œè®©å¤šä¸ªæ™ºèƒ½ä½“åƒèœ‚ç¾¤ä¸€æ ·ååŒæ€è€ƒã€‚</p>
                </div>
                <div class="bento-card reveal-up" style="transition-delay: 0.2s">
                    <div class="card-icon"><i class="fas fa-shield-alt"></i></div>
                    <h3>é‡‘èçº§å®‰å…¨</h3>
                    <p>ç§æœ‰åŒ–éƒ¨ç½²æ”¯æŒï¼Œæ•°æ®ä¸å‡ºåŸŸã€‚</p>
                </div>
                <div class="bento-card reveal-up" style="transition-delay: 0.3s">
                    <div class="card-icon"><i class="fas fa-plug"></i></div>
                    <h3>æ— é™æ’ä»¶</h3>
                    <p>å…¼å®¹ 5000+ å¸¸ç”¨ SaaS å·¥å…· APIã€‚</p>
                </div>
                <div class="bento-card span-3 reveal-up" style="transition-delay: 0.4s">
                    <div class="content-row">
                        <div>
                            <h3>å…¨çƒèŠ‚ç‚¹éƒ¨ç½²</h3>
                            <p>æ— è®ºèº«åœ¨ä½•å¤„ï¼Œéƒ½èƒ½è·å¾—æœ€ä½å»¶è¿Ÿçš„æ™ºèƒ½å“åº”ã€‚</p>
                        </div>
                        <div class="map-decoration"><i class="fas fa-globe-asia"></i></div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="footer-inner reveal-up">
            <h2>Ready to transform?</h2>
            <button onclick="scrollToSection('hero')" class="glow-btn">Login Now</button>
            <p class="copyright">Â© 2026 Queen Bee Inc. Design by QB. v1.0.0</p>
        </div>
    </footer>

    <script src="/static/cdn_resourc/layui/js/layui.js"></script>
    <script>
        // ç§»åŠ¨è®¾å¤‡æ£€æµ‹
        function isMobileDevice() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
                   (window.innerWidth <= 768 && 'ontouchstart' in window);
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æµ‹è®¾å¤‡ç±»å‹
        document.addEventListener('DOMContentLoaded', () => {
            if (isMobileDevice()) {
                // ç¦ç”¨ç™»å½•è¡¨å•
                const loginForm = document.getElementById('loginForm');
                const loginBtn = document.querySelector('.login-btn');
                const sendCodeBtn = document.getElementById('sendCodeBtn');

                if (loginForm) {
                    loginForm.style.opacity = '0.5';
                    loginForm.style.pointerEvents = 'none';
                }
                if (loginBtn) loginBtn.disabled = true;
                if (sendCodeBtn) sendCodeBtn.disabled = true;

                // æ˜¾ç¤ºæç¤ºæ¡†
                if (typeof layui !== 'undefined') {
                    layui.use('layer', function(){
                        var layer = layui.layer;
                        layer.open({
                            type: 1,
                            title: 'æ¸©é¦¨æç¤º',
                            area: ['300px', 'auto'],
                            closeBtn: 0,
                            shadeClose: false,
                            content: '<div style="padding: 20px; text-align: center;">' +
                                     '<div style="font-size: 48px; margin-bottom: 15px;">ğŸ“±</div>' +
                                     '<p style="font-size: 16px; color: #333; margin-bottom: 10px;"><strong>æš‚ä¸æ”¯æŒç§»åŠ¨ç«¯ç™»å½•</strong></p>' +
                                     '<p style="font-size: 14px; color: #666; line-height: 1.6;">ä¸ºäº†è·å¾—æœ€ä½³ä½“éªŒï¼Œè¯·ä½¿ç”¨ç”µè„‘æµè§ˆå™¨è®¿é—®</p>' +
                                     '<p style="font-size: 14px; color: #666; line-height: 1.6; margin-top: 10px;">æˆ‘ä»¬æ­£åœ¨ä¼˜åŒ–ç§»åŠ¨ç«¯ä½“éªŒï¼Œæ•¬è¯·æœŸå¾…~</p>' +
                                     '</div>',
                            success: function(layero, index) {
                                // å±…ä¸­æ˜¾ç¤º
                                layero.css('top', '50%').css('margin-top', -layero.height()/2);
                            }
                        });
                    });
                } else {
                    alert('æ¸©é¦¨æç¤ºï¼š\n\næš‚ä¸æ”¯æŒç§»åŠ¨ç«¯ç™»å½•ï¼Œè¯·ä½¿ç”¨ç”µè„‘æµè§ˆå™¨è®¿é—®\n\næˆ‘ä»¬æ­£åœ¨ä¼˜åŒ–ç§»åŠ¨ç«¯ä½“éªŒï¼Œæ•¬è¯·æœŸå¾…~');
                }
            }
        });

        // è§†è§‰äº¤äº’
        document.addEventListener('DOMContentLoaded', () => {
            const observerOptions = { threshold: 0.1 };
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) entry.target.classList.add('active');
                });
            }, observerOptions);
            document.querySelectorAll('.reveal-up, .reveal-down, .reveal-left, .reveal-right, .reveal-scale').forEach(el => observer.observe(el));

            // èƒŒæ™¯å…‰çƒè§†å·®
            window.addEventListener('scroll', () => {
                const scrolled = window.pageYOffset;
                document.querySelectorAll('.light-orb').forEach((orb, index) => {
                    orb.style.transform = `translateY(${scrolled * (index + 1) * 0.1}px)`;
                });
            });

            // å›¾ç‰‡å€¾æ–œ
            const tiltImages = document.querySelectorAll('.tilt-image');
            document.addEventListener('mousemove', (e) => {
                const x = (window.innerWidth / 2 - e.pageX) / 60;
                const y = (window.innerHeight / 2 - e.pageY) / 60;
                tiltImages.forEach(img => {
                    img.style.transform = `rotateY(${x}deg) rotateX(${y}deg)`;
                });
            });
        });

        window.scrollToSection = function(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        };

        // === æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ (åŸæ ·ä¿ç•™) ===
        layui.use(['form', 'layer'], function(){
            var form = layui.form;
            var layer = layui.layer;

            // å¾®å°˜ç²’å­æ•ˆæœ (æ·±è‰²ç²’å­)
            function createParticles() {
                const container = document.getElementById('particles');
                if(!container) return;
                container.innerHTML = '';
                for(let i=0; i<60; i++) {
                    const p = document.createElement('div');
                    p.style.position = 'absolute';
                    p.style.width = Math.random() * 3 + 'px';
                    p.style.height = p.style.width;
                    // ç²’å­é¢œè‰²æ”¹ä¸ºæ·±å¡å…¶/ç°è‰²ï¼Œä»¥é€‚åº”æµ…è‰²èƒŒæ™¯
                    p.style.background = 'rgba(139, 126, 102, ' + (Math.random() * 0.4 + 0.1) + ')';
                    p.style.left = Math.random() * 100 + '%';
                    p.style.top = Math.random() * 100 + '%';
                    p.style.borderRadius = '50%';
                    // éšæœºæµ®åŠ¨åŠ¨ç”»
                    p.style.animation = `floatParticle ${Math.random()*10 + 10}s infinite linear`;
                    container.appendChild(p);
                }
            }
            createParticles();

            // ä¸‹é¢æ˜¯å®Œå…¨ç›¸åŒçš„ç™»å½•é€»è¾‘
            const API_BASE_URL = '/api/v1';

            function getFingerprint() {
                const key = 'clientFingerprint';
                let value = localStorage.getItem(key);
                if (!value) {
                    value = 'fp-' + Math.random().toString(36).slice(2) + Date.now().toString(36);
                    localStorage.setItem(key, value);
                }
                return value;
            }

            function getStoredCode(phone) {
                if (!phone) return '';
                const key = 'loginCodeByPhone';
                const raw = localStorage.getItem(key);
                if (!raw) return '';
                try {
                    const data = JSON.parse(raw);
                    const entry = data[phone];
                    if (typeof entry === 'string') return entry;
                    if (entry && typeof entry === 'object') {
                        const expiresAt = Number(entry.expiresAt || 0);
                        if (expiresAt && Date.now() > expiresAt) {
                            delete data[phone];
                            localStorage.setItem(key, JSON.stringify(data));
                            return '';
                        }
                        return entry.code || '';
                    }
                    return '';
                } catch (err) { return ''; }
            }

            function storeCode(phone, code, expiresAt) {
                if (!phone || !code) return;
                const key = 'loginCodeByPhone';
                let data = {};
                const raw = localStorage.getItem(key);
                if (raw) {
                    try { data = JSON.parse(raw) || {}; } catch (err) { data = {}; }
                }
                if (expiresAt) {
                    data[phone] = { code, expiresAt };
                } else {
                    data[phone] = code;
                }
                localStorage.setItem(key, JSON.stringify(data));
            }

            function getCooldownUntil() {
                return Number(localStorage.getItem('loginCodeCooldownUntil') || 0);
            }

            function setCooldownUntil(untilTs) {
                localStorage.setItem('loginCodeCooldownUntil', String(untilTs));
            }

            function clearCooldown() {
                localStorage.removeItem('loginCodeCooldownUntil');
            }

            const phoneInput = document.querySelector('input[name="phone"]');
            const codeInput = document.querySelector('input[name="code"]');
            const sendCodeBtn = document.getElementById('sendCodeBtn');
            const clearPhoneBtn = document.getElementById('clearPhoneBtn');

            function updateSendCodeState(phone) {
                const cooldownUntil = getCooldownUntil();
                const now = Date.now();
                if (cooldownUntil > now) {
                    const remaining = Math.max(0, Math.ceil((cooldownUntil - now) / 1000));
                    sendCodeBtn.disabled = true;
                    sendCodeBtn.textContent = `${remaining}s`;
                    sendCodeBtn.dataset.cooldown = '1';
                    sendCodeBtn.classList.remove('verified');
                    codeInput.disabled = false;

                    // å¯åŠ¨æ–°çš„å®šæ—¶å™¨ç»§ç»­å€’è®¡æ—¶
                    const timerKey = 'sendCodeTimer';
                    if (sendCodeBtn[timerKey]) {
                        clearInterval(sendCodeBtn[timerKey]);
                    }
                    sendCodeBtn[timerKey] = setInterval(() => {
                        const currentRemaining = Math.max(0, Math.ceil((getCooldownUntil() - Date.now()) / 1000));
                        if (currentRemaining <= 0) {
                            clearInterval(sendCodeBtn[timerKey]);
                            sendCodeBtn[timerKey] = null;
                            clearCooldown();
                            const saved = getStoredCode(phoneInput.value.trim());
                            if (saved) {
                                sendCodeBtn.textContent = 'å·²è®¤è¯';
                                sendCodeBtn.classList.add('verified');
                                sendCodeBtn.dataset.cooldown = '1';
                                sendCodeBtn.disabled = true;
                                codeInput.disabled = true;
                            } else {
                                sendCodeBtn.dataset.cooldown = '0';
                                sendCodeBtn.textContent = 'è·å–éªŒè¯ç ';
                                sendCodeBtn.disabled = false;
                                codeInput.disabled = false;
                            }
                            return;
                        }
                        sendCodeBtn.textContent = `${currentRemaining}s`;
                    }, 1000);

                    return;
                }
                const savedCode = getStoredCode(phone);
                if (savedCode) {
                    sendCodeBtn.disabled = true;
                    sendCodeBtn.textContent = 'å·²è®¤è¯';
                    sendCodeBtn.dataset.cooldown = '1';
                    sendCodeBtn.classList.add('verified');
                    codeInput.disabled = true;
                    return;
                }
                sendCodeBtn.disabled = false;
                sendCodeBtn.textContent = 'è·å–éªŒè¯ç ';
                sendCodeBtn.dataset.cooldown = '0';
                sendCodeBtn.classList.remove('verified');
                codeInput.disabled = false;
            }

            function getStoredPhone() { return localStorage.getItem('loginPhone') || ''; }
            function storePhone(phone) { if (!phone) return; localStorage.setItem('loginPhone', phone); }

            phoneInput.addEventListener('input', () => {
                const phone = phoneInput.value.trim();
                storePhone(phone);
                const savedCode = getStoredCode(phone);
                if (savedCode) codeInput.value = savedCode;
                updateSendCodeState(phone);
            });
            codeInput.addEventListener('input', () => {
                const phone = phoneInput.value.trim();
                const code = codeInput.value.trim();
                storeCode(phone, code);
            });

            const savedPhone = getStoredPhone();
            if (savedPhone) phoneInput.value = savedPhone;
            const initialSaved = getStoredCode(phoneInput.value.trim());
            if (initialSaved) codeInput.value = initialSaved;
            updateSendCodeState(phoneInput.value.trim());

            // åè®®å‹¾é€‰çŠ¶æ€è®°å¿†
            const agreeCheckbox = document.getElementById('agreeCheckbox');
            const savedAgreement = localStorage.getItem('loginAgreed');
            if (savedAgreement === 'true') {
                agreeCheckbox.checked = true;
            }

            agreeCheckbox.addEventListener('change', () => {
                localStorage.setItem('loginAgreed', agreeCheckbox.checked);
            });

            clearPhoneBtn.addEventListener('click', () => {
                localStorage.removeItem('loginPhone');
                phoneInput.value = '';
                codeInput.value = '';
                updateSendCodeState('');
                layer.msg('è´¦å·å·²æ¸…é™¤', {icon: 1});
            });

            function isValidPhone(phone) { return /^1\d{10}$/.test(phone); }

            document.getElementById('loginForm').addEventListener('submit', function(e){
                e.preventDefault();
                const formData = {
                    phone: phoneInput.value,
                    code: codeInput.value
                };

                if (!isValidPhone(formData.phone.trim())) {
                    layer.msg('è¯·è¾“å…¥æ­£ç¡®çš„11ä½æ‰‹æœºå·', {icon: 2});
                    return false;
                }

                // æ£€æŸ¥æ˜¯å¦åŒæ„åè®®
                const agreeCheckbox = document.getElementById('agreeCheckbox');
                if (!agreeCheckbox.checked) {
                    layer.msg('è¯·é˜…è¯»å¹¶åŒæ„ã€Šç”¨æˆ·åè®®ã€‹å’Œã€Šéšç§æ”¿ç­–ã€‹', {icon: 2});
                    return false;
                }

                const submitBtn = document.querySelector('.login-btn');
                const originalContent = submitBtn.innerHTML;
                submitBtn.innerHTML = '<i class="layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop"></i> ç™»å½•ä¸­...';
                submitBtn.disabled = true;

                fetch(`${API_BASE_URL}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ phone: formData.phone, code: formData.code })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        localStorage.setItem('token', data.token);
                        localStorage.setItem('user', JSON.stringify(data.user));
                        localStorage.setItem('isLoggedIn', 'true');
                        const phoneKey = formData.phone.trim();
                        let shouldSetExpiry = true;
                        try {
                            const raw = localStorage.getItem('loginCodeByPhone');
                            if (raw) {
                                const data = JSON.parse(raw) || {};
                                const entry = data[phoneKey];
                                if (entry && typeof entry === 'object' && entry.expiresAt) {
                                    const expiresAt = Number(entry.expiresAt) || 0;
                                    if (expiresAt && Date.now() <= expiresAt) {
                                        shouldSetExpiry = false;
                                    }
                                }
                            }
                        } catch (err) {
                            shouldSetExpiry = true;
                        }
                        if (shouldSetExpiry) {
                            storeCode(phoneKey, formData.code.trim(), Date.now() + 25 * 24 * 60 * 60 * 1000);
                        }

                        layer.msg('ç™»å½•æˆåŠŸï¼', {icon: 1, time: 1000});
                        setTimeout(() => { window.location.href = '/chat'; }, 500);
                    } else {
                        layer.msg(data.detail || 'ç™»å½•å¤±è´¥', {icon: 2});
                    }
                })
                .catch(error => {
                    layer.msg('ç½‘ç»œé”™è¯¯', {icon: 2});
                })
                .finally(() => {
                    submitBtn.innerHTML = originalContent;
                    submitBtn.disabled = false;
                });
                return false;
            });

            sendCodeBtn.addEventListener('click', function() {
                const phone = phoneInput.value.trim();
                if (!phone || !isValidPhone(phone)) { layer.msg('æ‰‹æœºå·æ ¼å¼é”™è¯¯', {icon: 2}); return; }
                if (sendCodeBtn.dataset.cooldown === '1') return;
                if (sendCodeBtn.disabled) return;

                sendCodeBtn.disabled = true;
                const originalText = sendCodeBtn.textContent;
                sendCodeBtn.textContent = 'å‘é€ä¸­...';

                fetch(`${API_BASE_URL}/auth/send_code`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Client-Fingerprint': getFingerprint()
                    },
                    body: JSON.stringify({ phone })
                })
                .then(response => response.json().then(data => ({ ok: response.ok, data })))
                .then(({ ok, data }) => {
                    if (ok && data.status === 'success') {
                        layer.msg('éªŒè¯ç å·²å‘é€', {icon: 1});
                        sendCodeBtn.dataset.cooldown = '1';
                        sendCodeBtn.classList.remove('verified');
                        let remaining = 60;
                        setCooldownUntil(Date.now() + remaining * 1000);
                        sendCodeBtn.textContent = `${remaining}s`;
                        sendCodeBtn.disabled = true;
                        const timerKey = 'sendCodeTimer';
                        if (sendCodeBtn[timerKey]) {
                            clearInterval(sendCodeBtn[timerKey]);
                        }
                        sendCodeBtn[timerKey] = setInterval(() => {
                            remaining -= 1;
                            if (remaining <= 0) {
                                clearInterval(sendCodeBtn[timerKey]);
                                sendCodeBtn[timerKey] = null;
                                clearCooldown();
                                const saved = getStoredCode(phoneInput.value.trim());
                                if (saved) {
                                    sendCodeBtn.textContent = 'å·²è®¤è¯';
                                    sendCodeBtn.classList.add('verified');
                                    sendCodeBtn.dataset.cooldown = '1';
                                    sendCodeBtn.disabled = true;
                                } else {
                                    sendCodeBtn.dataset.cooldown = '0';
                                    sendCodeBtn.textContent = 'è·å–éªŒè¯ç ';
                                    sendCodeBtn.disabled = false;
                                }
                                return;
                            }
                            setCooldownUntil(Date.now() + remaining * 1000);
                            sendCodeBtn.textContent = `${remaining}s`;
                        }, 1000);
                    } else {
                        layer.msg(data.detail || 'å‘é€å¤±è´¥', {icon: 2});
                        sendCodeBtn.disabled = false;
                        sendCodeBtn.textContent = originalText;
                    }
                })
                .catch(() => {
                    layer.msg('ç½‘ç»œé”™è¯¯', {icon: 2});
                    sendCodeBtn.disabled = false;
                    sendCodeBtn.textContent = originalText;
                });
            });
        });
    </script>
</body>
</html>
